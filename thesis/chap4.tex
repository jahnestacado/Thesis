\chapter{BFA Variations}

\section{Variation 1 - Special ASCII subset fingerprint training}
In this variation we created 10 fingerprints which were trained using the training set, one for each file type. We used only the printable ASCII characters (32 b 126) among with the tab(9), new line (10) and the carriage return(13) characters. The results can be found in table 4.1. This variation of BFA classifies 589,758 fragments as text which corresponds to the 30.4\% of the initial corpus. 501,012 of them are fragments that come from pdf, xls, doc and text files and 88,746 fragments originate from the other 6 file types. This means that in the set that is classified as text we have an 85\% true positive of identifying document-type fragments as text with 15\% false positives. This 85\% of true positives corresponds to the 66.7\% of the total pdf, xls, doc and text files of our corpus.

\input{bfa_results_var1}

\section{Variation 2 - 4-Ratio categories of our special ASCII subset}
During our research we thought that it would be interesting to analyse the distribution of bytes that belong to our special ASCII subset in the fragments of our training set. Depending on the percentage of our special ASCII subset in a fragment, the fragment was assigned to one of 4 ratio categories. 0-25\%, 25-50\%, 50-75\% and 75-100\%. The results of this analysis can be found in table 4.2. As it seems fragments from certain file types are more likely to belong to certain ratio categories. For example almost all text fragments(99.95\%) contain more than 75\% of our special ASCII subset and almost all xls fragments less than 50\%. Undoubtedly this is completely reasonable. Text files are mostly comprised of plain text and Excel sheets, with their cell-like structure, contain less printable characters. And this analogy is more obvious in a 512-byte fragment. That finding can be used as a metric to improve current classification techniques and we are going to elaborate more on this later in this document.
Based on the analysis results  we thought that would be interesting to divide the fragments of our training set in 4 such categories. Then for each category and for each file type we created their respective fingerprints. So we ended up with 40 fingerprints, 4 for every file type. The algorithm checks first the ratio of our special ASCII subset of the input fragment and according to its value it compares the fragment with the fingerprints of the respective category. The results of this BFA variation can be found in the table 4.2. The accuracy for both the actual classification and the text classification are really bad. This probably because of some of the fingerprints were trained with a tiny amount of fragments so there are not representative at all for the category they were build for. For example it is obvious that in the 0-25\% category the xls fingerprint was trained with the 62.83\% of the total xls fragments and the ogg fingerprints, for this particular category, were trained with only the 0.02\% of the total ogg fragments. This is probably the reason why in the 0-25\% category most of the fragments were classified as xls since most of the other fingerprints, with the only exception of the xls, were under-trained. This observation led as to the formulation of the next variation.

%Additionally, due to the fact that in some of this categories the amount of fragments in several file types is almost zero we decided to eliminate this fingerprints.
%which contained more than 75\% of our special ASCII subset for the mp4 and a tiny amount of fragments for zip a

\input{bfa_ratio_analysis}

\section{Variation 3 - Dominant Category Fingerprints}
If we look at the table 4.2 it is obvious that most fragments of a certain file type are expected to belong to one of the 4 categories that we discussed in the previous variation. We hypothesized that for every file type the category which contains the majority of files  fragments is more representative than the others. So from the 4 fingerprints that we created for every file type for the previous BFA variation we chose the one which had the biggest amount of fragments. We call this category the dominant category of the file type. For example the dominant category of the text file type is the 75-100\%, for the pdf is the 25-50\% etc. Consequently, we ended up with 10 fingerprints witch corresponds to the dominant categories of every file type. This variation is identical with the first one, we the only difference that we use the fragments of the dominant category of every file type to train our fingerprints instead of the whole fragments set. The results of this BFA variation can be found in the table 4.3. As we can this BFA variation classifies 589,402 fragments as text which corresponds to the 30.3\% of the initial corpus. 490,267 of them are fragments that come from pdf, xls, doc and text files and 99,135 fragments originate from the other 6 file types. This means that in the set that is classified as text we have an 83.2\% true positive of identifying document-type fragments as text with 16.8\% false positives. This percentage of true positives corresponds to the 65.3\% of the total pdf, xls, doc and text files of our corpus.

\section{Variation 4 - Every fragment with ratio above 75\% of our special ASCII subset classified as text } 
According to the results of table 4.X (Fingerprint Ratio Analysis) almost all text fragments(99.5\%) contain more than 75\% of our special ASCII subset. In the same ratio category, fragments of pdf, doc and xls correspond to 15.66\%, 10.98\% and 1.28\%, of the total amount of fragments of their particular file type, respectively. All the other file types have less than 1\% of their total fragments in this ratio category. We thought that it would be interesting to apply the BFA of variation 1 only to the fragments which have less than 75\% of our special ASCII subset and every fragment above this percentage should be classified as text. We should note that we decided to use the fingerprints of the variation 1 instead of the dominant fingerprints of variation 2, because overall percentage of text fragment classification is better for variation 1. 
If we look at 4.X (default BFA) and table 4.X (Dominant-Results) the accuracy percentages of the variation 3 for the document-type fragments are all higher than the variation 1, with the only exception of the xls file type. The variation 1 gave us a 95.5\% true positives for the xls fragments compared to the 81.7\% of the dominant fingerprints. 
However, since a tiny amount of xls fragments, 1.28\% of total xls fragments, reside in the category 75-100\%, the accuracy percentage of variation 3 wont have the potential to increase much , therefore the overall text fragment classification true positives of variation 1 for fragments that contain less than 75\% will be higher than the one from variation 3. 
