\chapter{BFA Variations}

\section{Variation 1 - Special ASCII subset fingerprint training}

In this variation we created 10 fingerprints which were trained with fragments from the training set, one for each file type. We used only the printable ASCII characters (32 $\geq$  b $\leq$ 126) among with the tab(9), new line (10) and the carriage return(13) characters. The results can be found in Table \ref{table:table 4.1}.\\\\
 This variation of BFA classifies 589,758 fragments as text which corresponds to the 30.4\% of the initial corpus. 501,012 of them are fragments that come from pdf, xls, doc and text files and 88,746 fragments originate from the other 6 file types. This means that in the set that is classified as text we have an 85\% of true positives in identifying document-type fragments as text with 15\% false positives. This 85\% of true positives corresponds to the 66.7\% of the total pdf, xls, doc and text files of our corpus.

\input{bfa_results_var1}


\section{Variation 2 - 4-Ratio categories of our special ASCII subset}
During our research we thought that it would be interesting to analyse the distribution of bytes that belong to our special ASCII subset of the training set fragments. Depending on the percentage of our special ASCII subset in a fragment, the fragment was assigned to one of 4 ratio categories. 0-25\%, 25-50\%, 50-75\% and 75-100\%. The results of this analysis can be found in Table ~\ref{table:table 4.2}. As it seems fragments from certain file types are more likely to belong to certain ratio categories. For example almost all text fragments(99.95\%) contain more than 75\% of our special ASCII subset and almost all xls fragments less than 50\%. Undoubtedly this is completely reasonable. Text files are mostly comprised of plain text and Excel sheets, with their cell-like structure, contain less printable characters. And this analogy is more obvious in a 512-byte fragment. That finding can be used as a metric to improve current classification techniques and we are going to elaborate more on this later in this document.\\
\input{bfa_ratio_analysis}

Based on the analysis results  we thought that would be interesting to divide the fragments of our training set in 4 such categories. Then for each category and for each file type we created their respective fingerprints. So we ended up with 40 fingerprints, 4 for every file type. The algorithm checks first the ratio of our special ASCII subset of the input fragment and according to its value it compares the fragment with the fingerprints of the respective category. The results of this BFA variation can be found in Tables ~\ref{table:table 4.3}, \ref{table:table 4.4}, \ref{table:table 4.5} and \ref{table:table 4.6}.\\ The accuracy for both the actual classification and the text classification are really bad. This variation classified 366,969 fragments as text which corresponds to the 18.9\% of the initial corpus. 87,837 of them are fragments that come from pdf, xls, doc and text files and 279,132 fragments originate from the other 6 file types. This means that in the set that is classified as text we have an 31.5\% of true positives in identifying document-type fragments as text with 68.5\% false positives. This percentage of true positives corresponds to the 11.7\% of the total pdf, xls, doc and text files of our corpus.\\
\input{bfa_results_ratio_categories}

 The bad results are probably due to the fact that some of the fingerprints were trained with a tiny amount of fragments, so there are not representative at all, for the category they were build for. For example it is obvious that in the 0-25\% category the xls fingerprint was trained with the 62.83\% of the total xls fragments and the ogg fingerprint, for this particular category, was trained with only the 0.02\% of the total ogg fragments. Probably this is the reason why in the 0-25\% category most of the fragments were classified as xls since most of the other fingerprints, with the only exception of xls, were under-trained. This observation led as to the formulation of the next variation.

%Additionally, due to the fact that in some of this categories the amount of fragments in several file types is almost zero we decided to eliminate this fingerprints.
%which contained more than 75\% of our special ASCII subset for the mp4 and a tiny amount of fragments for zip a



\section{Variation 3 - Dominant Category Fingerprints}
If we look at the table 4.2 it is obvious that most fragments of a certain file type are expected to belong to one of the 4 categories that we discussed in the previous variation. We hypothesized that for every file type the category which contains the majority of files  fragments is more representative for the respective file type than the others. So from the 4 fingerprints that we created for every file type for the previous BFA variation, we chose the one which was trained with fragments that belonged in the ratio category with the biggest amount of fragments. We call this category the dominant category of the file type. For example the dominant category of the text file type is the 75-100\%, for the pdf is the 25-50\% etc. Consequently, we ended up with 10 fingerprints witch corresponds to the dominant categories of every file type. This variation is identical with the first one, with the only difference that we use the fragments of the dominant category of every file type to train our fingerprints instead of the whole fragment set. The results of this BFA variation can be found in Table ~\ref{table:table 4.7}.\\


 This BFA variation classified 589,402 fragments as text which corresponds to the 30.3\% of the initial corpus. 490,267 of them are fragments that come from pdf, xls, doc and text files and 99,135 fragments originate from the other 6 file types. This means that in the set that is classified as text we have an 83.2\% of true positives in identifying document-type fragments as text with 16.8\% false positives. This percentage of true positives corresponds to the 65.3\% of the total pdf, xls, doc and text files of our corpus.
 \input{bfa_results_dominant}

\section{Variation 4 - Every fragment with ratio above 75\% of our special ASCII subset classified as text } 
According to the results of table 4.X (Fingerprint Ratio Analysis) almost all text fragments(99.5\%) contain more than 75\% of our special ASCII subset. In the same ratio category, fragments of pdf, doc and xls correspond to 15.66\%, 10.98\% and 1.28\%, of the total amount of fragments of their particular file type, respectively. All other file types have less than 1\% of their total fragments in this ratio category. We thought that it would be interesting to apply the BFA of variation 1 only to the fragments which have less than 75\% of our special ASCII subset and every fragment above this percentage would be classified as text. We should note that we decided to use the fingerprints of variation 1 instead of the dominant fingerprints of variation 2, because overall percentage of text fragment classification is better for variation 1. 
%If we look at 4.X (default BFA) and table 4.X (Dominant-Results) the accuracy percentages of  variation 3 for the document-type fragments are a little higher than variation 1, with the only exception of the xls file type. The variation 1 gave us a 95.5\% true positives for the xls fragments compared to the 81.7\% of the dominant fingerprints. By any means this difference is not negligible.
%However, since a tiny amount of xls fragments, 1.28\% of total xls fragments, reside in the category 75-100\%, the accuracy percentage of variation 3 wont have the potential to increase much. Therefore the overall text fragment classification true positives of variation 1 for fragments that contain less than 75\% will be higher than the one from variation 3.
 The results of this variation of BFA can be found in Table \ref{table:table 4.8}.\\\\
  This BFA variation classified 590,834 fragments as text which corresponds to the 30.4\% of the initial corpus. 512,855 of them are fragments that come from pdf, xls, doc and text files and 77,979 fragments originate from the other 6 file types. This means that in the set that is classified as text we have an 86.8\% of true positives in identifying document-type fragments as text with 13.2\% false positives. This percentage of true positives corresponds to the 68.3\% of the total pdf, xls, doc and text files of our corpus.
  \input{bfa_results_var4}

\section{Optimal Variation for Text Fragment Classification}
It is obvious that the second variation is by far the worst and cannot aid the design process of our classification algorithm. Among the other three variation, variation 4 yields the best results. Both coverage and accuracy of variation 4 is undoubtedly the highest among the other two. However, taking under account that these are results from a controlled corpus and not from a real life scenario, the fact that variation 4 classifies every fragment with more than 75\% ratio of our special ASCII subset as text is a major weakness.\\\\
 In a real life scenario, the ratio between the amount of fragments of every file type it is highly unlikely to be 1:1, as it is in our corpus. Therefore in a scenario where the corpus does not contain any text fragments, every fragment with a ratio higher than 75\% of our special ASCII subset will be falsely classified as text. Furthermore, our corpus is comprised only of 10 file types. Considering the fact that the number of file types that a forensic practitioner is likely to encounter in real life cases is way bigger, renders variation 4 unscalable. We should conduct similar research for all file types first, in order to be able to say if variation 4 can be used in actual forensic cases. Among the remaining variations, variation 1 is slightly better in both coverage and accuracy than variation 3. We judge that this is the optimal variation of BFA for text fragment classification and will be used as the initial phase of our classification algorithm.


\section{BFA Training - complete ASCII set VS plain text }
Although BFA variation 1 yielded the best results regarding test fragment classification among the other 3 variation, a comparison with a BFA which use the complete ASCII byte set is essential, in order to choose which approach is the best for the design of our algorithm. Ashim[] tested a BFA for fragment classification using the exact same file types as we did. The only exception is that he used the whole ASCII byte set for the fingerprint training. The corpus that he used is almost 10 times bigger than the one we used for training. Conveniently enough, he trained his fingerprints with 10\%, 20\%, 50\% and 100\% of his training data set and provided the accuracy results. Our training set, around 100mb for each file type, is approximately the 10\% of Ashims training set. In order to have a more objective comparison, we are going to compare the results that Ashim got by using fingerprints which were trained with the 10\% of his training set, with our BFA variation 1. This way fingerprints from both approaches received the same amount of training. The results can be found in Table ~\ref{table:table 4.8}.\\\\ 
  \input{bfa_results_ashims}
 For broad fragment classification, fingerprints that use the whole byte set seems to be way more effective than ours of variation 1. Only the accuracies for pdf and ppt are higher in variation 1, simply because Ashims BFA achieved 0\% of true positives for these file types. Regarding text fragment classification the accuracy results are pretty close. We applied the percentages that result in text classification of Ashims BFA to our testing set. According to this, that BFA classified 428,182 fragments as text which corresponds to the 22\% of the initial corpus. 380,614 of them are fragments that come from pdf, xls, doc and text files and 47,567 fragments originate from the other 6 file types. This means that in the set that is classified as text we have an 89.9\% of true positives in identifying document-type fragments as text with 11.1\% false positives. This percentage of true positives corresponds to the 50.7\% of the total pdf, xls, doc and text files of our corpus.\\\\
 
 Although the accuracy of Ashims results is slightly higher(89.9\%) than variation 1(85\%), the amount of document-type fragments that is classified as text is significantly lower. Variation 1 classified as text 66.7\% of the total pdf, xls, doc and text fragments, in comparison to Ashims BFA that classified as text only the 50.7\% of them. By using BFA as the first phase of our algorithm, we aim to retrieve us much pdf, xls, doc and text fragments as possible and minimize false positives. In that case, this is a trade-off between accuracy and the amount of document-type fragment retrieval. Accuracy levels are pretty close. However, variation 1 classifies significantly more(16\%) pdf, xls, doc and text fragments of the total corpus as text. For that reason, we chose to use variation 1 over a BFA which use trained fingerprints with the complete ASCII byte set, for the initial design phase of our classification algorithm.
 
 

